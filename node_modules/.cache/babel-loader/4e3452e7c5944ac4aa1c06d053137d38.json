{"ast":null,"code":"import _toConsumableArray from \"C:\\\\Users\\\\\\uAE40\\uBBFC\\uC7AC\\\\Desktop\\\\projects\\\\jd-api-server-client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/toConsumableArray\";\nimport _regeneratorRuntime from \"C:\\\\Users\\\\\\uAE40\\uBBFC\\uC7AC\\\\Desktop\\\\projects\\\\jd-api-server-client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";\nimport _asyncToGenerator from \"C:\\\\Users\\\\\\uAE40\\uBBFC\\uC7AC\\\\Desktop\\\\projects\\\\jd-api-server-client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";\nimport { GuestTypeAdd } from \"./assigIntrerface\";\nimport { TimePerMs } from \"../../../../types/enum\";\nimport { setMidNight } from \"../../../../utils/utils\";\nimport { CLASS_MOVING, CLASS_LINKED } from \"./items/itemRenderFn\";\nimport moment from \"moment\";\nimport $ from \"jquery\";\nimport { ASSIG_DATA_END, ASSIG_DATA_START, ASSIG_DATA_START_LIMITE, ASSIG_DATA_END_LIMITE } from \"../timelineConfig\";\nimport { ReactTooltip } from \"../../../../atoms/tooltip/Tooltip\";\nexport function getAssigHandlers(_ref, _ref2, _ref3) {\n  var getItemById = _ref.getItemById,\n      allTooltipsHide = _ref.allTooltipsHide,\n      createMark = _ref.createMark,\n      openCanvasMenuTooltip = _ref.openCanvasMenuTooltip,\n      resizeLinkedItems = _ref.resizeLinkedItems,\n      allocateItem = _ref.allocateItem,\n      resizeBlockBlock = _ref.resizeBlockBlock,\n      openBlockMenu = _ref.openBlockMenu,\n      popUpItemMenuTooltip = _ref.popUpItemMenuTooltip,\n      moveLinkedItems = _ref.moveLinkedItems,\n      removeMark = _ref.removeMark,\n      toogleCheckInOut = _ref.toogleCheckInOut;\n  var groupData = _ref2.groupData,\n      isMobile = _ref2.isMobile;\n  var setDataTime = _ref3.setDataTime,\n      dataTime = _ref3.dataTime,\n      bookingModal = _ref3.bookingModal,\n      guestValue = _ref3.guestValue,\n      setGuestValue = _ref3.setGuestValue;\n\n  // 단축키\n  var shortKey =\n  /*#__PURE__*/\n  function () {\n    var _ref4 = _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee(flag, e, time, groupId, itemId) {\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              if (flag === \"canvas\") {\n                if (e.ctrlKey) {// addBlock(time!, groupId!);\n                }\n              }\n\n              if (flag === \"guestItem\") {\n                if (e.ctrlKey) {\n                  toogleCheckInOut(itemId);\n                }\n              }\n\n            case 2:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function shortKey(_x, _x2, _x3, _x4, _x5) {\n      return _ref4.apply(this, arguments);\n    };\n  }();\n\n  var handleItemDoubleClick =\n  /*#__PURE__*/\n  function () {\n    var _ref5 = _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee2(itemId, e, time) {\n      var location, target;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              console.info(\"handleItemDoubleClick\");\n\n              if (e.persist) {\n                _context2.next = 3;\n                break;\n              }\n\n              return _context2.abrupt(\"return\");\n\n            case 3:\n              e.persist();\n              location = {\n                clientX: e.clientX,\n                clientY: e.clientY\n              };\n              target = getItemById(itemId);\n              popUpItemMenuTooltip(location, target);\n              if (target.type === GuestTypeAdd.GUEST) bookingModal.openModal({\n                bookingId: target.bookingId\n              });\n\n            case 8:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n\n    return function handleItemDoubleClick(_x6, _x7, _x8) {\n      return _ref5.apply(this, arguments);\n    };\n  }(); // 핸들 캔버스 더블클릭시\n\n\n  var handleCanvasDoubleClick =\n  /*#__PURE__*/\n  function () {\n    var _ref6 = _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee3(groupId, time, e) {\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3);\n    }));\n\n    return function handleCanvasDoubleClick(_x9, _x10, _x11) {\n      return _ref6.apply(this, arguments);\n    };\n  }(); //  캔버스 클릭시 호출됨\n\n\n  var handleCanvasClick =\n  /*#__PURE__*/\n  function () {\n    var _ref7 = _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee4(groupId, time, e) {\n      return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              console.info(\"handleCanvasClick\");\n\n              if (e && e.persist) {\n                e.persist();\n              }\n\n              allTooltipsHide();\n              if (!e.shiftKey) setGuestValue(_toConsumableArray(guestValue.filter(function (guest) {\n                return guest.type !== GuestTypeAdd.MARK;\n              })));\n              _context4.next = 6;\n              return allTooltipsHide();\n\n            case 6:\n              openCanvasMenuTooltip(e);\n              createMark(time, time + TimePerMs.DAY, [groupId]); // if (shortKey) await shortKey(\"canvas\", e, time, groupId);\n\n              $(\".assigItem\").removeClass(CLASS_LINKED);\n\n            case 9:\n            case \"end\":\n              return _context4.stop();\n          }\n        }\n      }, _callee4);\n    }));\n\n    return function handleCanvasClick(_x12, _x13, _x14) {\n      return _ref7.apply(this, arguments);\n    };\n  }(); // 핸들 움직일때 벨리데이션 (마우스 움직이면 호출됨)\n  // 새로운 시간을 리턴하거나 time을 리턴하세요.\n\n\n  var handleMoveResizeValidator = function handleMoveResizeValidator(action, item, time, resizeEdge) {\n    allTooltipsHide();\n\n    if (action === \"resize\") {\n      // 최소 아이템줌 설정\n      if (item.start >= time) return item.end;\n      if (setMidNight(Date.now()) >= time) return item.end; // resizeValidater(item, time);\n\n      if (item.type !== GuestTypeAdd.BLOCK) {\n        resizeLinkedItems(item.bookingId, time);\n      }\n    }\n\n    if (action === \"move\") {\n      // 🦄 예약날자 수정이 안료되면 적용\n      return item.start;\n\n      if (time < setMidNight(moment().valueOf())) {\n        return item.start;\n      }\n\n      $(\".assigItem--booking\".concat(item.bookingId)).addClass(CLASS_MOVING);\n      $(\"#assigItem--item\".concat(item.id)).removeClass(CLASS_MOVING);\n      var targetGroup = groupData.find(function (group) {\n        return group.id === item.group;\n      }); // 이동하는곳 성별 제한 확인\n\n      if (targetGroup) {// 💔💔💔💔 아이템이 기존 아이템과 동일한 상태라서 group이 New 그룹이 아닙니다 ㅠㅠㅠ\n      }\n\n      moveLinkedItems(item.bookingId, time);\n    }\n\n    return time;\n  }; // 드래그를 토대로 마크들을 생성시킴\n\n\n  var handleDraggingCell = function handleDraggingCell(e, moveCounts, dotPoint) {\n    var timeStart = dotPoint.timeStart,\n        placeIndex = dotPoint.placeIndex;\n    var x = moveCounts.x,\n        y = moveCounts.y;\n    var timeEnd = timeStart + TimePerMs.DAY * x + TimePerMs.DAY;\n    var ids = [];\n\n    for (var i = 0; i <= y; i++) {\n      if (!groupData[placeIndex + i]) return;\n      ids.push(groupData[placeIndex + i].id);\n    }\n\n    if (timeEnd < timeStart) {\n      var timeTemp = timeStart;\n      timeStart = timeEnd;\n      timeEnd = timeTemp;\n    }\n\n    createMark(timeStart, timeEnd, ids);\n  }; // 핸들 아이템 움직일시 (마우스 놓아야 호출됨)\n\n\n  var handleItemMove =\n  /*#__PURE__*/\n  function () {\n    var _ref8 = _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee5(itemId, dragTime, newGroupOrder) {\n      var targetGuest;\n      return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n        while (1) {\n          switch (_context5.prev = _context5.next) {\n            case 0:\n              targetGuest = getItemById(itemId);\n\n              if (targetGuest) {\n                _context5.next = 3;\n                break;\n              }\n\n              return _context5.abrupt(\"return\");\n\n            case 3:\n              allocateItem(targetGuest, newGroupOrder); // $(`.${CLASS_MOVING}`).removeClass(CLASS_MOVING);\n\n            case 4:\n            case \"end\":\n              return _context5.stop();\n          }\n        }\n      }, _callee5);\n    }));\n\n    return function handleItemMove(_x15, _x16, _x17) {\n      return _ref8.apply(this, arguments);\n    };\n  }(); // 핸들 아이템 리사이즈시 (마우스 놓아야 호출됨)\n\n\n  var handleItemResize =\n  /*#__PURE__*/\n  function () {\n    var _ref9 = _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee6(itemId, time, edge) {\n      var targetGuest;\n      return _regeneratorRuntime.wrap(function _callee6$(_context6) {\n        while (1) {\n          switch (_context6.prev = _context6.next) {\n            case 0:\n              targetGuest = getItemById(itemId);\n\n              if (targetGuest.type === GuestTypeAdd.BLOCK) {\n                resizeBlockBlock(targetGuest, time);\n              }\n\n            case 2:\n            case \"end\":\n              return _context6.stop();\n          }\n        }\n      }, _callee6);\n    }));\n\n    return function handleItemResize(_x18, _x19, _x20) {\n      return _ref9.apply(this, arguments);\n    };\n  }(); // 핸들 아이템 클릭\n\n\n  var handleItemClick =\n  /*#__PURE__*/\n  function () {\n    var _ref10 = _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee7(itemId, e, time) {\n      var target, clientX, clientY, location;\n      return _regeneratorRuntime.wrap(function _callee7$(_context7) {\n        while (1) {\n          switch (_context7.prev = _context7.next) {\n            case 0:\n              console.info(\"handleItemClick\");\n              e.persist && e.persist();\n              target = getItemById(itemId);\n\n              if (!(target.type === GuestTypeAdd.MARK)) {\n                _context7.next = 5;\n                break;\n              }\n\n              return _context7.abrupt(\"return\");\n\n            case 5:\n              _context7.next = 7;\n              return removeMark();\n\n            case 7:\n              _context7.next = 9;\n              return allTooltipsHide();\n\n            case 9:\n              if (e.clientX) {\n                _context7.next = 11;\n                break;\n              }\n\n              return _context7.abrupt(\"return\");\n\n            case 11:\n              clientX = e.clientX, clientY = e.clientY;\n              location = {\n                clientX: clientX + 10,\n                clientY: clientY + 15\n              };\n\n              if (!(target.bookingId === \"block\")) {\n                _context7.next = 15;\n                break;\n              }\n\n              return _context7.abrupt(\"return\");\n\n            case 15:\n              if (!isMobile) {\n                _context7.next = 19;\n                break;\n              }\n\n              if (target.type === GuestTypeAdd.BLOCK) openBlockMenu(location, {\n                item: target\n              }); // if (target.type === GuestTypeAdd.MAKE)\n              // openCreateMenu(location, {item: target});\n\n              _context7.next = 21;\n              break;\n\n            case 19:\n              _context7.next = 21;\n              return popUpItemMenuTooltip(location, target);\n\n            case 21:\n              if (!shortKey) {\n                _context7.next = 24;\n                break;\n              }\n\n              _context7.next = 24;\n              return shortKey(\"guestItem\", e, undefined, undefined, itemId);\n\n            case 24:\n            case \"end\":\n              return _context7.stop();\n          }\n        }\n      }, _callee7);\n    }));\n\n    return function handleItemClick(_x21, _x22, _x23) {\n      return _ref10.apply(this, arguments);\n    };\n  }();\n\n  var handleDraggingEnd = function handleDraggingEnd(e) {\n    openCanvasMenuTooltip(e);\n  }; // 타임라인 이동시\n\n\n  var handleTimeChange = function handleTimeChange(visibleTimeStart, visibleTimeEnd, updateScrollCanvas) {\n    allTooltipsHide();\n    var dataLimitEnd = dataTime.end - TimePerMs.DAY * ASSIG_DATA_END_LIMITE;\n    var dataLimitStart = dataTime.start + TimePerMs.DAY * ASSIG_DATA_START_LIMITE; //  뒤로 요청\n\n    if (visibleTimeStart < dataLimitStart) {\n      var queryStart = visibleTimeStart - TimePerMs.DAY * ASSIG_DATA_START;\n      var queryEnd = visibleTimeEnd + TimePerMs.DAY * ASSIG_DATA_END;\n      setDataTime({\n        start: setMidNight(queryStart),\n        end: setMidNight(queryEnd)\n      });\n    } //  앞으로 요청\n\n\n    if (dataLimitEnd < visibleTimeEnd) {\n      var _queryStart = visibleTimeStart - TimePerMs.DAY * ASSIG_DATA_START;\n\n      var _queryEnd = visibleTimeEnd + TimePerMs.DAY * ASSIG_DATA_END;\n\n      setDataTime({\n        start: setMidNight(_queryStart),\n        end: setMidNight(_queryEnd)\n      });\n    }\n\n    updateScrollCanvas(visibleTimeStart, visibleTimeEnd);\n  }; // 🐭 캔버스 오른쪽 클릭\n\n\n  var handleCanvasContextMenu = function handleCanvasContextMenu(groupId, time, e) {}; // 🐭 아이템이 선택되었을때\n\n\n  var handleItemSelect =\n  /*#__PURE__*/\n  function () {\n    var _ref11 = _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee8(itemId, e, time) {\n      var target, targetEl;\n      return _regeneratorRuntime.wrap(function _callee8$(_context8) {\n        while (1) {\n          switch (_context8.prev = _context8.next) {\n            case 0:\n              handleItemClick(itemId, e, time);\n              target = getItemById(itemId);\n\n              if (!target) {\n                _context8.next = 6;\n                break;\n              }\n\n              _context8.next = 5;\n              return $(\".assigItem\").removeClass(CLASS_LINKED);\n\n            case 5:\n              $(\".assigItem--booking\".concat(target.bookingId)).addClass(CLASS_LINKED);\n\n            case 6:\n              if (!(target.type === GuestTypeAdd.GUEST)) {\n                _context8.next = 14;\n                break;\n              }\n\n              _context8.next = 9;\n              return removeMark();\n\n            case 9:\n              _context8.next = 11;\n              return allTooltipsHide();\n\n            case 11:\n              targetEl = $(\"#assigItem__configIconWrapId\".concat(target.id)).get(0);\n              ReactTooltip.show(targetEl);\n              $(\"#itemTooltip\").addClass(\"itemTooltip--show\");\n\n            case 14:\n            case \"end\":\n              return _context8.stop();\n          }\n        }\n      }, _callee8);\n    }));\n\n    return function handleItemSelect(_x24, _x25, _x26) {\n      return _ref11.apply(this, arguments);\n    };\n  }();\n\n  var handleMouseDownCanvas = function handleMouseDownCanvas(e) {};\n\n  var assigHandler = {\n    handleCanvasClick: handleCanvasClick,\n    handleMouseDownCanvas: handleMouseDownCanvas,\n    handleCanvasDoubleClick: handleCanvasDoubleClick,\n    handleItemClick: handleItemClick,\n    handleItemDoubleClick: handleItemDoubleClick,\n    handleItemMove: handleItemMove,\n    handleItemResize: handleItemResize,\n    handleDraggingEnd: handleDraggingEnd,\n    handleMoveResizeValidator: handleMoveResizeValidator,\n    handleTimeChange: handleTimeChange,\n    handleCanvasContextMenu: handleCanvasContextMenu,\n    handleItemSelect: handleItemSelect,\n    handleDraggingCell: handleDraggingCell\n  };\n  return assigHandler;\n}","map":{"version":3,"sources":["C:/Users/김민재/Desktop/projects/jd-api-server-client/src/pages/middleServer/assig/components/assigHandlers.tsx"],"names":["GuestTypeAdd","TimePerMs","setMidNight","CLASS_MOVING","CLASS_LINKED","moment","$","ASSIG_DATA_END","ASSIG_DATA_START","ASSIG_DATA_START_LIMITE","ASSIG_DATA_END_LIMITE","ReactTooltip","getAssigHandlers","getItemById","allTooltipsHide","createMark","openCanvasMenuTooltip","resizeLinkedItems","allocateItem","resizeBlockBlock","openBlockMenu","popUpItemMenuTooltip","moveLinkedItems","removeMark","toogleCheckInOut","groupData","isMobile","setDataTime","dataTime","bookingModal","guestValue","setGuestValue","shortKey","flag","e","time","groupId","itemId","ctrlKey","handleItemDoubleClick","console","info","persist","location","clientX","clientY","target","type","GUEST","openModal","bookingId","handleCanvasDoubleClick","handleCanvasClick","shiftKey","filter","guest","MARK","DAY","removeClass","handleMoveResizeValidator","action","item","resizeEdge","start","end","Date","now","BLOCK","valueOf","addClass","id","targetGroup","find","group","handleDraggingCell","moveCounts","dotPoint","timeStart","placeIndex","x","y","timeEnd","ids","i","push","timeTemp","handleItemMove","dragTime","newGroupOrder","targetGuest","handleItemResize","edge","handleItemClick","undefined","handleDraggingEnd","handleTimeChange","visibleTimeStart","visibleTimeEnd","updateScrollCanvas","dataLimitEnd","dataLimitStart","queryStart","queryEnd","handleCanvasContextMenu","handleItemSelect","targetEl","get","show","handleMouseDownCanvas","assigHandler"],"mappings":"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","sourcesContent":["import {\r\n  THandleItemDoubleClick,\r\n  IAssigTimelineHooks,\r\n  IAssigTimelineUtils,\r\n  THandleItemClick,\r\n  THandleCanvasClick,\r\n  THandleMoveResizeValidator,\r\n  IAssigItem,\r\n  GuestTypeAdd,\r\n  IAssigHandlers,\r\n  THandleItemResize,\r\n  THandleItemMove,\r\n  THandleCanvasDoubleClick,\r\n  THandleTimeChange,\r\n  THandleCanvasContextMenu,\r\n  THandleItemSelect,\r\n  IAssigTimelineContext,\r\n  TShortKey,\r\n  THandleDraggingCell,\r\n  THandleMouseDown,\r\n  THandleDraggingEnd\r\n} from \"./assigIntrerface\";\r\nimport { TimePerMs } from \"../../../../types/enum\";\r\nimport { setMidNight } from \"../../../../utils/utils\";\r\nimport { CLASS_MOVING, CLASS_LINKED } from \"./items/itemRenderFn\";\r\nimport moment from \"moment\";\r\nimport $ from \"jquery\";\r\nimport {\r\n  ASSIG_DATA_END,\r\n  ASSIG_DATA_START,\r\n  ASSIG_DATA_START_LIMITE,\r\n  ASSIG_DATA_END_LIMITE\r\n} from \"../timelineConfig\";\r\nimport { ReactTooltip } from \"../../../../atoms/tooltip/Tooltip\";\r\n\r\nexport function getAssigHandlers(\r\n  {\r\n    getItemById,\r\n    allTooltipsHide,\r\n    createMark,\r\n    openCanvasMenuTooltip,\r\n    resizeLinkedItems,\r\n    allocateItem,\r\n    resizeBlockBlock,\r\n    openBlockMenu,\r\n    popUpItemMenuTooltip,\r\n    moveLinkedItems,\r\n    removeMark,\r\n    toogleCheckInOut\r\n  }: IAssigTimelineUtils,\r\n  { groupData, isMobile }: IAssigTimelineContext,\r\n  {\r\n    setDataTime,\r\n    dataTime,\r\n    bookingModal,\r\n    guestValue,\r\n    setGuestValue\r\n  }: IAssigTimelineHooks\r\n): IAssigHandlers {\r\n  // 단축키\r\n  const shortKey: TShortKey = async (\r\n    flag: \"canvas\" | \"guestItem\",\r\n    e: React.MouseEvent<HTMLElement>,\r\n    time?: number,\r\n    groupId?: string,\r\n    itemId?: string\r\n  ) => {\r\n    if (flag === \"canvas\") {\r\n      if (e.ctrlKey) {\r\n        // addBlock(time!, groupId!);\r\n      }\r\n    }\r\n    if (flag === \"guestItem\") {\r\n      if (e.ctrlKey) {\r\n        toogleCheckInOut(itemId!);\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleItemDoubleClick: THandleItemDoubleClick = async (\r\n    itemId: string,\r\n    e: React.MouseEvent<HTMLElement>,\r\n    time: number\r\n  ) => {\r\n    console.info(\"handleItemDoubleClick\");\r\n    if (!e.persist) return;\r\n    e.persist();\r\n    const location = {\r\n      clientX: e.clientX,\r\n      clientY: e.clientY\r\n    };\r\n    const target = getItemById(itemId);\r\n    popUpItemMenuTooltip(location, target);\r\n\r\n    if (target.type === GuestTypeAdd.GUEST)\r\n      bookingModal.openModal({ bookingId: target.bookingId });\r\n  };\r\n\r\n  // 핸들 캔버스 더블클릭시\r\n  const handleCanvasDoubleClick: THandleCanvasDoubleClick = async (\r\n    groupId: string,\r\n    time: number,\r\n    e: React.MouseEvent<HTMLElement>\r\n  ) => {\r\n    // 현재 인터페이스만 존재하는 함수 입니다.\r\n  };\r\n\r\n  //  캔버스 클릭시 호출됨\r\n  const handleCanvasClick: THandleCanvasClick = async (\r\n    groupId: string,\r\n    time: number,\r\n    e: React.MouseEvent<HTMLElement>\r\n  ) => {\r\n    console.info(\"handleCanvasClick\");\r\n    if (e && e.persist) {\r\n      e.persist();\r\n    }\r\n\r\n    allTooltipsHide();\r\n    if (!e.shiftKey)\r\n      setGuestValue([\r\n        ...guestValue.filter(guest => guest.type !== GuestTypeAdd.MARK)\r\n      ]);\r\n\r\n    await allTooltipsHide();\r\n\r\n    openCanvasMenuTooltip(e);\r\n    createMark(time, time + TimePerMs.DAY, [groupId]);\r\n\r\n    // if (shortKey) await shortKey(\"canvas\", e, time, groupId);\r\n    $(\".assigItem\").removeClass(CLASS_LINKED);\r\n  };\r\n  // 핸들 움직일때 벨리데이션 (마우스 움직이면 호출됨)\r\n  // 새로운 시간을 리턴하거나 time을 리턴하세요.\r\n  const handleMoveResizeValidator: THandleMoveResizeValidator = (\r\n    action: \"move\" | \"resize\",\r\n    item: IAssigItem,\r\n    time: number,\r\n    resizeEdge: \"left\" | \"right\" | undefined\r\n  ) => {\r\n    allTooltipsHide();\r\n    if (action === \"resize\") {\r\n      // 최소 아이템줌 설정\r\n      if (item.start >= time) return item.end;\r\n      if (setMidNight(Date.now()) >= time) return item.end;\r\n\r\n      // resizeValidater(item, time);\r\n\r\n      if (item.type !== GuestTypeAdd.BLOCK) {\r\n        resizeLinkedItems(item.bookingId, time);\r\n      }\r\n    }\r\n\r\n    if (action === \"move\") {\r\n      // 🦄 예약날자 수정이 안료되면 적용\r\n      return item.start;\r\n\r\n      if (time < setMidNight(moment().valueOf())) {\r\n        return item.start;\r\n      }\r\n\r\n      $(`.assigItem--booking${item.bookingId}`).addClass(CLASS_MOVING);\r\n      $(`#assigItem--item${item.id}`).removeClass(CLASS_MOVING);\r\n\r\n      const targetGroup = groupData.find(group => group.id === item.group);\r\n      // 이동하는곳 성별 제한 확인\r\n      if (targetGroup) {\r\n        // 💔💔💔💔 아이템이 기존 아이템과 동일한 상태라서 group이 New 그룹이 아닙니다 ㅠㅠㅠ\r\n      }\r\n      moveLinkedItems(item.bookingId, time);\r\n    }\r\n\r\n    return time;\r\n  };\r\n\r\n  // 드래그를 토대로 마크들을 생성시킴\r\n  const handleDraggingCell: THandleDraggingCell = (e, moveCounts, dotPoint) => {\r\n    let { timeStart, placeIndex } = dotPoint;\r\n    const { x, y } = moveCounts;\r\n    let timeEnd = timeStart + TimePerMs.DAY * x + TimePerMs.DAY;\r\n    const ids = [];\r\n    for (let i = 0; i <= y; i++) {\r\n      if (!groupData[placeIndex + i]) return;\r\n      ids.push(groupData[placeIndex + i].id);\r\n    }\r\n\r\n    if (timeEnd < timeStart) {\r\n      const timeTemp = timeStart;\r\n      timeStart = timeEnd;\r\n      timeEnd = timeTemp;\r\n    }\r\n    createMark(timeStart, timeEnd, ids);\r\n  };\r\n\r\n  // 핸들 아이템 움직일시 (마우스 놓아야 호출됨)\r\n  const handleItemMove: THandleItemMove = async (\r\n    itemId: string,\r\n    dragTime: number,\r\n    newGroupOrder: number\r\n  ) => {\r\n    const targetGuest = getItemById(itemId);\r\n    if (!targetGuest) return;\r\n\r\n    allocateItem(targetGuest, newGroupOrder);\r\n    // $(`.${CLASS_MOVING}`).removeClass(CLASS_MOVING);\r\n  };\r\n\r\n  // 핸들 아이템 리사이즈시 (마우스 놓아야 호출됨)\r\n  const handleItemResize: THandleItemResize = async (\r\n    itemId: string,\r\n    time: number,\r\n    edge: \"left\" | \"right\"\r\n  ) => {\r\n    const targetGuest = getItemById(itemId);\r\n    if (targetGuest.type === GuestTypeAdd.BLOCK) {\r\n      resizeBlockBlock(targetGuest, time);\r\n    }\r\n  };\r\n\r\n  // 핸들 아이템 클릭\r\n  const handleItemClick: THandleItemClick = async (\r\n    itemId: string,\r\n    e: React.MouseEvent<HTMLElement>,\r\n    time: number\r\n  ) => {\r\n    console.info(\"handleItemClick\");\r\n    e.persist && e.persist();\r\n    const target = getItemById(itemId);\r\n    if (target.type === GuestTypeAdd.MARK) return;\r\n    await removeMark();\r\n    await allTooltipsHide();\r\n    if (!e.clientX) return;\r\n\r\n    const { clientX, clientY } = e;\r\n    const location = {\r\n      clientX: clientX + 10,\r\n      clientY: clientY + 15\r\n    };\r\n\r\n    if (target.bookingId === \"block\") return;\r\n\r\n    if (isMobile) {\r\n      if (target.type === GuestTypeAdd.BLOCK)\r\n        openBlockMenu(location, { item: target });\r\n      // if (target.type === GuestTypeAdd.MAKE)\r\n      // openCreateMenu(location, {item: target});\r\n    } else {\r\n      await popUpItemMenuTooltip(location, target);\r\n    }\r\n\r\n    if (shortKey) await shortKey(\"guestItem\", e, undefined, undefined, itemId);\r\n  };\r\n\r\n  const handleDraggingEnd: THandleDraggingEnd = e => {\r\n    openCanvasMenuTooltip(e);\r\n  };\r\n\r\n  // 타임라인 이동시\r\n  const handleTimeChange: THandleTimeChange = (\r\n    visibleTimeStart: number,\r\n    visibleTimeEnd: number,\r\n    updateScrollCanvas: any\r\n  ) => {\r\n    allTooltipsHide();\r\n    const dataLimitEnd = dataTime.end - TimePerMs.DAY * ASSIG_DATA_END_LIMITE;\r\n    const dataLimitStart =\r\n      dataTime.start + TimePerMs.DAY * ASSIG_DATA_START_LIMITE;\r\n\r\n    //  뒤로 요청\r\n    if (visibleTimeStart < dataLimitStart) {\r\n      const queryStart = visibleTimeStart - TimePerMs.DAY * ASSIG_DATA_START;\r\n      const queryEnd = visibleTimeEnd + TimePerMs.DAY * ASSIG_DATA_END;\r\n\r\n      setDataTime({\r\n        start: setMidNight(queryStart),\r\n        end: setMidNight(queryEnd)\r\n      });\r\n    }\r\n\r\n    //  앞으로 요청\r\n    if (dataLimitEnd < visibleTimeEnd) {\r\n      const queryStart = visibleTimeStart - TimePerMs.DAY * ASSIG_DATA_START;\r\n      const queryEnd = visibleTimeEnd + TimePerMs.DAY * ASSIG_DATA_END;\r\n\r\n      setDataTime({\r\n        start: setMidNight(queryStart),\r\n        end: setMidNight(queryEnd)\r\n      });\r\n    }\r\n    updateScrollCanvas(visibleTimeStart, visibleTimeEnd);\r\n  };\r\n\r\n  // 🐭 캔버스 오른쪽 클릭\r\n  const handleCanvasContextMenu: THandleCanvasContextMenu = (\r\n    groupId: string,\r\n    time: number,\r\n    e: React.MouseEvent<HTMLElement>\r\n  ) => {};\r\n\r\n  // 🐭 아이템이 선택되었을때\r\n  const handleItemSelect: THandleItemSelect = async (\r\n    itemId: string,\r\n    e: React.MouseEvent<HTMLElement>,\r\n    time: number\r\n  ) => {\r\n    handleItemClick(itemId, e, time);\r\n    const target = getItemById(itemId);\r\n    if (target) {\r\n      await $(\".assigItem\").removeClass(CLASS_LINKED);\r\n      $(`.assigItem--booking${target.bookingId}`).addClass(CLASS_LINKED);\r\n    }\r\n\r\n    if (target.type === GuestTypeAdd.GUEST) {\r\n      await removeMark();\r\n      await allTooltipsHide();\r\n      const targetEl = $(`#assigItem__configIconWrapId${target.id}`).get(0);\r\n      ReactTooltip.show(targetEl);\r\n      $(\"#itemTooltip\").addClass(\"itemTooltip--show\");\r\n    }\r\n  };\r\n\r\n  const handleMouseDownCanvas: THandleMouseDown = e => {};\r\n\r\n  const assigHandler: IAssigHandlers = {\r\n    handleCanvasClick,\r\n    handleMouseDownCanvas,\r\n    handleCanvasDoubleClick,\r\n    handleItemClick,\r\n    handleItemDoubleClick,\r\n    handleItemMove,\r\n    handleItemResize,\r\n    handleDraggingEnd,\r\n    handleMoveResizeValidator,\r\n    handleTimeChange,\r\n    handleCanvasContextMenu,\r\n    handleItemSelect,\r\n    handleDraggingCell\r\n  };\r\n\r\n  return assigHandler;\r\n}\r\n"]},"metadata":{},"sourceType":"module"}