{"ast":null,"code":"import _slicedToArray from \"C:\\\\Users\\\\\\uAE40\\uBBFC\\uC7AC\\\\Desktop\\\\projects\\\\jd-api-server-client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";\nimport _classCallCheck from \"C:\\\\Users\\\\\\uAE40\\uBBFC\\uC7AC\\\\Desktop\\\\projects\\\\jd-api-server-client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _possibleConstructorReturn from \"C:\\\\Users\\\\\\uAE40\\uBBFC\\uC7AC\\\\Desktop\\\\projects\\\\jd-api-server-client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"C:\\\\Users\\\\\\uAE40\\uBBFC\\uC7AC\\\\Desktop\\\\projects\\\\jd-api-server-client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"C:\\\\Users\\\\\\uAE40\\uBBFC\\uC7AC\\\\Desktop\\\\projects\\\\jd-api-server-client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"C:\\\\Users\\\\\\uAE40\\uBBFC\\uC7AC\\\\Desktop\\\\projects\\\\jd-api-server-client\\\\src\\\\pages\\\\bookingHost\\\\product\\\\SelectProductWrap.tsx\";\n\n/* eslint-disable camelcase */\nimport React, { useState, useEffect, Fragment } from \"react\";\nimport { Mutation, Query } from \"react-apollo\";\nimport { Redirect } from \"react-router-dom\";\nimport { GET_PRODUCTS_TYPES, BUY_PRODUCTS, GET_USER_INFO, REFUND_PRODUCT } from \"../../../queries\";\nimport { ErrProtecter, queryDataFormater, onCompletedMessage } from \"../../../utils/utils\";\nimport { ReactTooltip } from \"../../../atoms/tooltipList/TooltipList\";\nimport SelectProducts from \"./SelectProduct\";\nimport froductTypeManuFacter from \"./froductTypeManuFacter\";\nimport { LANG } from \"../../../hooks/hook\";\n\nvar GetProductTypes =\n/*#__PURE__*/\nfunction (_Query) {\n  _inherits(GetProductTypes, _Query);\n\n  function GetProductTypes() {\n    _classCallCheck(this, GetProductTypes);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(GetProductTypes).apply(this, arguments));\n  }\n\n  return GetProductTypes;\n}(Query);\n\nvar BuyProductMutation =\n/*#__PURE__*/\nfunction (_Mutation) {\n  _inherits(BuyProductMutation, _Mutation);\n\n  function BuyProductMutation() {\n    _classCallCheck(this, BuyProductMutation);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(BuyProductMutation).apply(this, arguments));\n  }\n\n  return BuyProductMutation;\n}(Mutation);\n\nvar RefundProductMutation =\n/*#__PURE__*/\nfunction (_Mutation2) {\n  _inherits(RefundProductMutation, _Mutation2);\n\n  function RefundProductMutation() {\n    _classCallCheck(this, RefundProductMutation);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(RefundProductMutation).apply(this, arguments));\n  }\n\n  return RefundProductMutation;\n}(Mutation);\n\n// currentProduct : 현재 적용중인 상품\nvar SelectProductWrap = function SelectProductWrap(_ref) {\n  var context = _ref.context;\n  var selectedHouse = context.house,\n      currentProduct = context.applyedProduct,\n      isPhoneVerified = context.user.isPhoneVerified;\n\n  var _useState = useState(false),\n      _useState2 = _slicedToArray(_useState, 2),\n      redirect = _useState2[0],\n      setRedirect = _useState2[1];\n\n  useEffect(function () {\n    ReactTooltip.rebuild();\n  });\n  var refetchQueries = [{\n    query: GET_USER_INFO\n  }];\n  return React.createElement(GetProductTypes, {\n    query: GET_PRODUCTS_TYPES,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 61\n    },\n    __self: this\n  }, function (_ref2) {\n    var productTypeDatas = _ref2.data,\n        loading = _ref2.loading;\n    var productTypes = queryDataFormater(productTypeDatas, \"GetAllProductTypes\", \"productTypes\", []);\n    var productTypeDesc = froductTypeManuFacter(productTypes || []);\n    return React.createElement(BuyProductMutation, {\n      mutation: BUY_PRODUCTS,\n      onCompleted: function onCompleted(_ref3) {\n        var BuyProduct = _ref3.BuyProduct;\n        onCompletedMessage(BuyProduct, LANG(\"product_application_completed\"), LANG(\"product_application_failed\"));\n        setRedirect(true);\n      },\n      refetchQueries: refetchQueries,\n      awaitRefetchQueries: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 71\n      },\n      __self: this\n    }, function (buyProductMu, _ref4) {\n      var buyProductLoading = _ref4.loading;\n      return React.createElement(RefundProductMutation, {\n        mutation: REFUND_PRODUCT,\n        refetchQueries: refetchQueries,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 85\n        },\n        __self: this\n      }, function (refundMu) {\n        return redirect ? React.createElement(Redirect, {\n          push: true,\n          to: \"/ready\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 91\n          },\n          __self: this\n        }) : React.createElement(Fragment, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 93\n          },\n          __self: this\n        }, React.createElement(SelectProducts, {\n          productTypes: productTypeDesc,\n          refundMu: refundMu,\n          buyProductMu: buyProductMu,\n          loading: loading,\n          mutationLoading: buyProductLoading,\n          selectedHouse: selectedHouse,\n          currentProduct: currentProduct,\n          isPhoneVerified: isPhoneVerified,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 94\n          },\n          __self: this\n        }));\n      });\n    });\n  });\n};\n\nexport default ErrProtecter(SelectProductWrap);","map":{"version":3,"sources":["C:/Users/김민재/Desktop/projects/jd-api-server-client/src/pages/bookingHost/product/SelectProductWrap.tsx"],"names":["React","useState","useEffect","Fragment","Mutation","Query","Redirect","GET_PRODUCTS_TYPES","BUY_PRODUCTS","GET_USER_INFO","REFUND_PRODUCT","ErrProtecter","queryDataFormater","onCompletedMessage","ReactTooltip","SelectProducts","froductTypeManuFacter","LANG","GetProductTypes","BuyProductMutation","RefundProductMutation","SelectProductWrap","context","selectedHouse","house","currentProduct","applyedProduct","isPhoneVerified","user","redirect","setRedirect","rebuild","refetchQueries","query","productTypeDatas","data","loading","productTypes","productTypeDesc","BuyProduct","buyProductMu","buyProductLoading","refundMu"],"mappings":";;;;;;;AAAA;AACA,OAAOA,KAAP,IAAeC,QAAf,EAAyBC,SAAzB,EAAoCC,QAApC,QAAmD,OAAnD;AACA,SAAQC,QAAR,EAAkBC,KAAlB,QAA8B,cAA9B;AACA,SAAQC,QAAR,QAAuB,kBAAvB;AACA,SACEC,kBADF,EAEEC,YAFF,EAGEC,aAHF,EAIEC,cAJF,QAKO,kBALP;AAMA,SACEC,YADF,EAEEC,iBAFF,EAGEC,kBAHF,QAIO,sBAJP;AAYA,SAAQC,YAAR,QAA2B,wCAA3B;AAEA,OAAOC,cAAP,MAA2B,iBAA3B;AACA,OAAOC,qBAAP,MAAkC,yBAAlC;AAEA,SAAQC,IAAR,QAAmB,qBAAnB;;IAEMC,e;;;;;;;;;;;;EAAwBb,K;;IACxBc,kB;;;;;;;;;;;;EAA2Bf,Q;;IAC3BgB,qB;;;;;;;;;;;;EAA8BhB,Q;;AAcpC;AACA,IAAMiB,iBAAmC,GAAG,SAAtCA,iBAAsC,OAAe;AAAA,MAAbC,OAAa,QAAbA,OAAa;AAAA,MAEhDC,aAFgD,GAKrDD,OALqD,CAEvDE,KAFuD;AAAA,MAGvCC,cAHuC,GAKrDH,OALqD,CAGvDI,cAHuD;AAAA,MAIhDC,eAJgD,GAKrDL,OALqD,CAIvDM,IAJuD,CAIhDD,eAJgD;;AAAA,kBAMzB1B,QAAQ,CAAC,KAAD,CANiB;AAAA;AAAA,MAMlD4B,QANkD;AAAA,MAMxCC,WANwC;;AAQzD5B,EAAAA,SAAS,CAAC,YAAM;AACdY,IAAAA,YAAY,CAACiB,OAAb;AACD,GAFQ,CAAT;AAIA,MAAMC,cAAc,GAAG,CAAC;AAACC,IAAAA,KAAK,EAAExB;AAAR,GAAD,CAAvB;AACA,SACE,oBAAC,eAAD;AAAiB,IAAA,KAAK,EAAEF,kBAAxB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACG,iBAAuC;AAAA,QAA/B2B,gBAA+B,SAArCC,IAAqC;AAAA,QAAbC,OAAa,SAAbA,OAAa;AACtC,QAAMC,YAAY,GAAGzB,iBAAiB,CACpCsB,gBADoC,EAEpC,oBAFoC,EAGpC,cAHoC,EAIpC,EAJoC,CAAtC;AAMA,QAAMI,eAAe,GAAGtB,qBAAqB,CAACqB,YAAY,IAAI,EAAjB,CAA7C;AACA,WACE,oBAAC,kBAAD;AACE,MAAA,QAAQ,EAAE7B,YADZ;AAEE,MAAA,WAAW,EAAE,4BAAkB;AAAA,YAAhB+B,UAAgB,SAAhBA,UAAgB;AAC7B1B,QAAAA,kBAAkB,CAChB0B,UADgB,EAEhBtB,IAAI,CAAC,+BAAD,CAFY,EAGhBA,IAAI,CAAC,4BAAD,CAHY,CAAlB;AAKAa,QAAAA,WAAW,CAAC,IAAD,CAAX;AACD,OATH;AAUE,MAAA,cAAc,EAAEE,cAVlB;AAWE,MAAA,mBAAmB,MAXrB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAaG,UAACQ,YAAD;AAAA,UAAyBC,iBAAzB,SAAgBL,OAAhB;AAAA,aACC,oBAAC,qBAAD;AACE,QAAA,QAAQ,EAAE1B,cADZ;AAEE,QAAA,cAAc,EAAEsB,cAFlB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAIG,UAAAU,QAAQ;AAAA,eACPb,QAAQ,GACN,oBAAC,QAAD;AAAU,UAAA,IAAI,MAAd;AAAe,UAAA,EAAE,EAAC,QAAlB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UADM,GAGN,oBAAC,QAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WACE,oBAAC,cAAD;AACE,UAAA,YAAY,EAAES,eADhB;AAEE,UAAA,QAAQ,EAAEI,QAFZ;AAGE,UAAA,YAAY,EAAEF,YAHhB;AAIE,UAAA,OAAO,EAAEJ,OAJX;AAKE,UAAA,eAAe,EAAEK,iBALnB;AAME,UAAA,aAAa,EAAElB,aANjB;AAOE,UAAA,cAAc,EAAEE,cAPlB;AAQE,UAAA,eAAe,EAAEE,eARnB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UADF,CAJK;AAAA,OAJX,CADD;AAAA,KAbH,CADF;AAyCD,GAlDH,CADF;AAsDD,CAnED;;AAqEA,eAAehB,YAAY,CAACU,iBAAD,CAA3B","sourcesContent":["/* eslint-disable camelcase */\r\nimport React, {useState, useEffect, Fragment} from \"react\";\r\nimport {Mutation, Query} from \"react-apollo\";\r\nimport {Redirect} from \"react-router-dom\";\r\nimport {\r\n  GET_PRODUCTS_TYPES,\r\n  BUY_PRODUCTS,\r\n  GET_USER_INFO,\r\n  REFUND_PRODUCT\r\n} from \"../../../queries\";\r\nimport {\r\n  ErrProtecter,\r\n  queryDataFormater,\r\n  onCompletedMessage\r\n} from \"../../../utils/utils\";\r\nimport {\r\n  buyProduct,\r\n  buyProductVariables,\r\n  refundProduct,\r\n  refundProductVariables,\r\n  getAllProductTypes\r\n} from \"../../../types/api\";\r\nimport {ReactTooltip} from \"../../../atoms/tooltipList/TooltipList\";\r\nimport {LayoutType} from \"../../../types/enum\";\r\nimport SelectProducts from \"./SelectProduct\";\r\nimport froductTypeManuFacter from \"./froductTypeManuFacter\";\r\nimport {IContext} from \"../BookingHostRouter\";\r\nimport {LANG} from \"../../../hooks/hook\";\r\n\r\nclass GetProductTypes extends Query<getAllProductTypes> {}\r\nclass BuyProductMutation extends Mutation<buyProduct, buyProductVariables> {}\r\nclass RefundProductMutation extends Mutation<\r\n  refundProduct,\r\n  refundProductVariables\r\n> {}\r\n\r\nexport interface IAdditionHook {\r\n  useLayout: boolean;\r\n  layoutType: LayoutType;\r\n  url: string;\r\n}\r\ninterface IProps {\r\n  context: IContext;\r\n}\r\n\r\n// currentProduct : 현재 적용중인 상품\r\nconst SelectProductWrap: React.FC<IProps> = ({context}) => {\r\n  const {\r\n    house: selectedHouse,\r\n    applyedProduct: currentProduct,\r\n    user: {isPhoneVerified}\r\n  } = context;\r\n  const [redirect, setRedirect] = useState(false);\r\n\r\n  useEffect(() => {\r\n    ReactTooltip.rebuild();\r\n  });\r\n\r\n  const refetchQueries = [{query: GET_USER_INFO}];\r\n  return (\r\n    <GetProductTypes query={GET_PRODUCTS_TYPES}>\r\n      {({data: productTypeDatas, loading}) => {\r\n        const productTypes = queryDataFormater(\r\n          productTypeDatas,\r\n          \"GetAllProductTypes\",\r\n          \"productTypes\",\r\n          []\r\n        );\r\n        const productTypeDesc = froductTypeManuFacter(productTypes || []);\r\n        return (\r\n          <BuyProductMutation\r\n            mutation={BUY_PRODUCTS}\r\n            onCompleted={({BuyProduct}) => {\r\n              onCompletedMessage(\r\n                BuyProduct,\r\n                LANG(\"product_application_completed\"),\r\n                LANG(\"product_application_failed\")\r\n              );\r\n              setRedirect(true);\r\n            }}\r\n            refetchQueries={refetchQueries}\r\n            awaitRefetchQueries\r\n          >\r\n            {(buyProductMu, {loading: buyProductLoading}) => (\r\n              <RefundProductMutation\r\n                mutation={REFUND_PRODUCT}\r\n                refetchQueries={refetchQueries}\r\n              >\r\n                {refundMu =>\r\n                  redirect ? (\r\n                    <Redirect push to=\"/ready\" />\r\n                  ) : (\r\n                    <Fragment>\r\n                      <SelectProducts\r\n                        productTypes={productTypeDesc}\r\n                        refundMu={refundMu}\r\n                        buyProductMu={buyProductMu}\r\n                        loading={loading}\r\n                        mutationLoading={buyProductLoading}\r\n                        selectedHouse={selectedHouse}\r\n                        currentProduct={currentProduct}\r\n                        isPhoneVerified={isPhoneVerified}\r\n                      />\r\n                    </Fragment>\r\n                  )\r\n                }\r\n              </RefundProductMutation>\r\n            )}\r\n          </BuyProductMutation>\r\n        );\r\n      }}\r\n    </GetProductTypes>\r\n  );\r\n};\r\n\r\nexport default ErrProtecter(SelectProductWrap);\r\n"]},"metadata":{},"sourceType":"module"}